"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[9214],{79214:(e,t,o)=>{o.r(t);o.d(t,{CONTROL_COMM_PROTOCOL_VERSION:()=>C,CONTROL_COMM_TARGET:()=>p,CONTROL_COMM_TIMEOUT:()=>b,ManagerBase:()=>E,base64ToBuffer:()=>d,bufferToBase64:()=>m,bufferToHex:()=>l,hexToBuffer:()=>i,serialize_state:()=>y});var n=o(18357);var r=o(5592);var s=o(67526);const a=["00","01","02","03","04","05","06","07","08","09","0A","0B","0C","0D","0E","0F","10","11","12","13","14","15","16","17","18","19","1A","1B","1C","1D","1E","1F","20","21","22","23","24","25","26","27","28","29","2A","2B","2C","2D","2E","2F","30","31","32","33","34","35","36","37","38","39","3A","3B","3C","3D","3E","3F","40","41","42","43","44","45","46","47","48","49","4A","4B","4C","4D","4E","4F","50","51","52","53","54","55","56","57","58","59","5A","5B","5C","5D","5E","5F","60","61","62","63","64","65","66","67","68","69","6A","6B","6C","6D","6E","6F","70","71","72","73","74","75","76","77","78","79","7A","7B","7C","7D","7E","7F","80","81","82","83","84","85","86","87","88","89","8A","8B","8C","8D","8E","8F","90","91","92","93","94","95","96","97","98","99","9A","9B","9C","9D","9E","9F","A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","AA","AB","AC","AD","AE","AF","B0","B1","B2","B3","B4","B5","B6","B7","B8","B9","BA","BB","BC","BD","BE","BF","C0","C1","C2","C3","C4","C5","C6","C7","C8","C9","CA","CB","CC","CD","CE","CF","D0","D1","D2","D3","D4","D5","D6","D7","D8","D9","DA","DB","DC","DD","DE","DF","E0","E1","E2","E3","E4","E5","E6","E7","E8","E9","EA","EB","EC","ED","EE","EF","F0","F1","F2","F3","F4","F5","F6","F7","F8","F9","FA","FB","FC","FD","FE","FF"];function l(e){const t=new Uint8Array(e);const o=[];for(let n=0;n<t.length;n++){o.push(a[t[n]])}return o.join("")}function i(e){const t=new Uint8Array(e.length/2);for(let o=0;o<e.length;o+=2){t[o/2]=parseInt(e.slice(o,o+2),16)}return t.buffer}function m(e){return(0,s.iI)(new Uint8Array(e))}function d(e){return(0,s.bg)(e).buffer}const c="$";const u=/(\$\$?|\\(?:begin|end)\{[a-z]*\*?\}|\\[{}$]|[{}]|(?:\n\s*)+|@@\d+@@|\\\\(?:\(|\)|\[|\]))/i;function _(e){const t=[];let o=null;let n=null;let r=null;let s=0;let a;const l=/`/.test(e);if(l){e=e.replace(/~/g,"~T").replace(/(^|[^\\])(`+)([^\n]*?[^`\n])\2(?!`)/gm,(e=>e.replace(/\$/g,"~D")));a=e=>e.replace(/~([TD])/g,((e,t)=>t==="T"?"~":c))}else{a=e=>e}let i=e.replace(/\r\n?/g,"\n").split(u);for(let m=1,d=i.length;m<d;m+=2){const e=i[m];if(e.charAt(0)==="@"){i[m]="@@"+t.length+"@@";t.push(e)}else if(o!==null){if(e===n){if(s){r=m}else{i=h(o,m,a,t,i);o=null;n=null;r=null}}else if(e.match(/\n.*\n/)){if(r!==null){m=r;i=h(o,m,a,t,i)}o=null;n=null;r=null;s=0}else if(e==="{"){s++}else if(e==="}"&&s){s--}}else{if(e===c||e==="$$"){o=m;n=e;s=0}else if(e==="\\\\("||e==="\\\\["){o=m;n=e.slice(-1)==="("?"\\\\)":"\\\\]";s=0}else if(e.substr(1,5)==="begin"){o=m;n="\\end"+e.substr(6);s=0}}}if(o!==null&&r!==null){i=h(o,r,a,t,i);o=null;n=null;r=null}return{text:a(i.join("")),math:t}}function f(e,t){const o=(e,o)=>{let n=t[o];if(n.substr(0,3)==="\\\\("&&n.substr(n.length-3)==="\\\\)"){n="\\("+n.substring(3,n.length-3)+"\\)"}else if(n.substr(0,3)==="\\\\["&&n.substr(n.length-3)==="\\\\]"){n="\\["+n.substring(3,n.length-3)+"\\]"}return n};return e.replace(/@@(\d+)@@/g,o)}function h(e,t,o,n,r){let s=r.slice(e,t+1).join("").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");if(navigator&&navigator.appName==="Microsoft Internet Explorer"){s=s.replace(/(%[^\n]*)\n/g,"$1<br/>\n")}while(t>e){r[t]="";t--}r[e]="@@"+n.length+"@@";if(o){s=o(s)}n.push(s);return r}var w=o(74728);var v=o.n(w);const g=n.PROTOCOL_VERSION.split(".",1)[0];const p="jupyter.widget.control";const C="1.0.0";const b=4e3;function A(e){const t=["a","abbr","b","code","em","i","img","li","ol","span","strong","ul"];const o={"*":["aria-*","class","style","title"],a:["href"],img:["src"],style:["media","type"]};return v()(e,{allowedTags:t,allowedAttributes:o})}class E{constructor(){this.comm_target_name="jupyter.widget";this._models=Object.create(null)}setViewOptions(e={}){return e}create_view(e,t={}){const o=(0,n.uuid)();const r=e.state_change=e.state_change.then((async()=>{const r=e.get("_view_name");const s=e.get("_view_module");try{const n=await this.loadViewClass(r,s,e.get("_view_module_version"));const a=new n({model:e,options:this.setViewOptions(t)});a.listenTo(e,"destroy",a.remove);await a.render();a.once("remove",(()=>{if(e.views){delete e.views[o]}}));return a}catch(a){console.error(`Could not create a view for model id ${e.model_id}`);const o=`Failed to create view for '${r}' from module '${s}' with model '${e.name}' from module '${e.module}'`;const l=n.createErrorWidgetModel(a,o);const i=new l;const m=new n.ErrorWidgetView({model:i,options:this.setViewOptions(t)});await m.render();return m}}));if(e.views){e.views[o]=r}return r}callbacks(e){return{}}async get_model(e){const t=this._models[e];if(t===undefined){throw new Error("widget model not found")}return t}has_model(e){return this._models[e]!==undefined}handle_comm_open(e,t){const o=(t.metadata||{})["version"]||"";if(o.split(".",1)[0]!==g){const e=`Wrong widget protocol version: received protocol version '${o}', but was expecting major version '${g}'`;console.error(e);return Promise.reject(e)}const r=t.content.data;const s=r.buffer_paths||[];const a=t.buffers||[];(0,n.put_buffers)(r.state,s,a);return this.new_model({model_name:r.state["_model_name"],model_module:r.state["_model_module"],model_module_version:r.state["_model_module_version"],comm:e},r.state).catch((0,n.reject)("Could not create a model.",true))}new_widget(e,t={}){let o;if(e.view_name===undefined||e.view_module===undefined||e.view_module_version===undefined){return Promise.reject("new_widget(...) must be given view information in the options.")}if(e.comm){o=Promise.resolve(e.comm)}else{o=this._create_comm(this.comm_target_name,e.model_id,{state:{_model_module:e.model_module,_model_module_version:e.model_module_version,_model_name:e.model_name,_view_module:e.view_module,_view_module_version:e.view_module_version,_view_name:e.view_name}},{version:n.PROTOCOL_VERSION})}const r=Object.assign({},e);return o.then((e=>{r.comm=e;const o=this.new_model(r,t);return o.then((e=>{e.sync("create",e);return e}))}),(()=>{if(!r.model_id){r.model_id=(0,n.uuid)()}return this.new_model(r,t)}))}register_model(e,t){this._models[e]=t;t.then((t=>{t.once("comm:close",(()=>{delete this._models[e]}))}))}async new_model(e,t={}){var o,n;const r=(o=e.model_id)!==null&&o!==void 0?o:(n=e.comm)===null||n===void 0?void 0:n.comm_id;if(!r){throw new Error("Neither comm nor model_id provided in options object. At least one must exist.")}e.model_id=r;const s=this._make_model(e,t);this.register_model(r,s);return await s}async _loadFromKernel(){let e;let t;try{const o=await this._create_comm(p,(0,n.uuid)(),{},{version:C});await new Promise(((n,r)=>{o.on_msg((o=>{e=o["content"]["data"];if(e.method!=="update_states"){console.warn(`\n              Unknown ${e.method} message on the Control channel\n            `);return}t=(o.buffers||[]).map((e=>{if(e instanceof DataView){return e}else{return new DataView(e instanceof ArrayBuffer?e:e.buffer)}}));n(null)}));o.on_close((()=>r("Control comm was closed too early")));o.send({method:"request_states"},{});setTimeout((()=>r("Control comm did not respond in time")),b)}));o.close()}catch(l){return this._loadFromKernelModels()}const o=e.states;const r={};const s={};for(let n=0;n<e.buffer_paths.length;n++){const[o,...a]=e.buffer_paths[n];const l=t[n];if(!r[o]){r[o]=[];s[o]=[]}r[o].push(a);s[o].push(l)}const a=await Promise.all(Object.keys(o).map((async e=>{const t=this.has_model(e)?undefined:await this._create_comm("jupyter.widget",e);return{widget_id:e,comm:t}})));await Promise.all(a.map((async({widget_id:e,comm:t})=>{const a=o[e];if(e in r){(0,n.put_buffers)(a,r[e],s[e])}try{if(t){await this.new_model({model_name:a.model_name,model_module:a.model_module,model_module_version:a.model_module_version,model_id:e,comm:t},a.state)}else{const t=await this.get_model(e);const o=await t.constructor._deserialize_state(a.state,this);t.set_state(o)}}catch(l){console.error(l)}})))}async _loadFromKernelModels(){const e=await this._get_comm_info();const t=await Promise.all(Object.keys(e).map((async e=>{if(this.has_model(e)){return}const t=await this._create_comm(this.comm_target_name,e);let o="";const s=new r.PromiseDelegate;t.on_msg((e=>{if(e.parent_header.msg_id===o&&e.header.msg_type==="comm_msg"&&e.content.data.method==="update"){const o=e.content.data;const r=o.buffer_paths||[];const a=e.buffers||[];(0,n.put_buffers)(o.state,r,a);s.resolve({comm:t,msg:e})}}));o=t.send({method:"request_state"},this.callbacks(undefined));return s.promise})));await Promise.all(t.map((async e=>{if(!e){return}const t=e.msg.content;await this.new_model({model_name:t.data.state._model_name,model_module:t.data.state._model_module,model_module_version:t.data.state._model_module_version,comm:e.comm},t.data.state)})))}async _make_model(e,t={}){const o=e.model_id;const r=this.loadModelClass(e.model_name,e.model_module,e.model_module_version);let s;const a=(e,t)=>{const o=n.createErrorWidgetModel(e,t);const r=new o;return r};try{s=await r}catch(i){const e="Could not instantiate widget";console.error(e);return a(i,e)}if(!s){const t="Could not instantiate widget";console.error(t);const o=new Error(`Cannot find model module ${e.model_module}@${e.model_module_version}, ${e.model_name}`);return a(o,t)}let l;try{const n=await s._deserialize_state(t,this);const r={widget_manager:this,model_id:o,comm:e.comm};l=new s(n,r)}catch(i){console.error(i);const t=`Model class '${e.model_name}' from module '${e.model_module}' is loaded but can not be instantiated`;l=a(i,t)}l.name=e.model_name;l.module=e.model_module;return l}clear_state(){return(0,n.resolvePromisesDict)(this._models).then((e=>{Object.keys(e).forEach((t=>e[t].close()));this._models=Object.create(null)}))}get_state(e={}){const t=Object.keys(this._models).map((e=>this._models[e]));return Promise.all(t).then((t=>y(t,e)))}set_state(e){if(!(e.version_major&&e.version_major<=2)){throw"Unsupported widget state format"}const t=e.state;const o=this._get_comm_info().then((e=>Promise.all(Object.keys(t).map((o=>{const r={base64:d,hex:i};const s=t[o];const a=s.state;if(s.buffers){const e=s.buffers.map((e=>e.path));const t=s.buffers.map((e=>new DataView(r[e.encoding](e.data))));(0,n.put_buffers)(s.state,e,t)}if(this.has_model(o)){return this.get_model(o).then((e=>e.constructor._deserialize_state(a||{},this).then((t=>{e.set_state(t);return e}))))}const l={model_id:o,model_name:s.model_name,model_module:s.model_module,model_module_version:s.model_module_version};if(Object.prototype.hasOwnProperty.call(e,"model_id")){return this._create_comm(this.comm_target_name,o).then((e=>{l.comm=e;return this.new_model(l)}))}else{return this.new_model(l,a)}})))));return o}disconnect(){Object.keys(this._models).forEach((e=>{this._models[e].then((e=>{e.comm_live=false}))}))}resolveUrl(e){return Promise.resolve(e)}inline_sanitize(e){const t=_(e);const o=A(t["text"]);return f(o,t["math"])}async loadModelClass(e,t,o){try{const n=this.loadClass(e,t,o);await n;return n}catch(r){console.error(r);const o=`Failed to load model class '${e}' from module '${t}'`;return n.createErrorWidgetModel(r,o)}}async loadViewClass(e,t,o){try{const n=this.loadClass(e,t,o);await n;return n}catch(r){console.error(r);const o=`Failed to load view class '${e}' from module '${t}'`;return n.createErrorWidgetView(r,o)}}filterExistingModelState(e){let t=e.state;t=Object.keys(t).filter((e=>!this.has_model(e))).reduce(((e,o)=>{e[o]=t[o];return e}),{});return Object.assign(Object.assign({},e),{state:t})}}function y(e,t={}){const o={};e.forEach((e=>{const r=e.model_id;const s=(0,n.remove_buffers)(e.serialize(e.get_state(t.drop_defaults)));const a=s.buffers.map(((e,t)=>({data:m(e),path:s.buffer_paths[t],encoding:"base64"})));o[r]={model_name:e.name,model_module:e.module,model_module_version:e.get("_model_module_version"),state:s.state};if(a.length>0){o[r].buffers=a}}));return{version_major:2,version_minor:0,state:o}}},67526:(e,t)=>{var o;o=d;t.bg=u;t.iI=h;var n=[];var r=[];var s=typeof Uint8Array!=="undefined"?Uint8Array:Array;var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var l=0,i=a.length;l<i;++l){n[l]=a[l];r[a.charCodeAt(l)]=l}r["-".charCodeAt(0)]=62;r["_".charCodeAt(0)]=63;function m(e){var t=e.length;if(t%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var o=e.indexOf("=");if(o===-1)o=t;var n=o===t?0:4-o%4;return[o,n]}function d(e){var t=m(e);var o=t[0];var n=t[1];return(o+n)*3/4-n}function c(e,t,o){return(t+o)*3/4-o}function u(e){var t;var o=m(e);var n=o[0];var a=o[1];var l=new s(c(e,n,a));var i=0;var d=a>0?n-4:n;var u;for(u=0;u<d;u+=4){t=r[e.charCodeAt(u)]<<18|r[e.charCodeAt(u+1)]<<12|r[e.charCodeAt(u+2)]<<6|r[e.charCodeAt(u+3)];l[i++]=t>>16&255;l[i++]=t>>8&255;l[i++]=t&255}if(a===2){t=r[e.charCodeAt(u)]<<2|r[e.charCodeAt(u+1)]>>4;l[i++]=t&255}if(a===1){t=r[e.charCodeAt(u)]<<10|r[e.charCodeAt(u+1)]<<4|r[e.charCodeAt(u+2)]>>2;l[i++]=t>>8&255;l[i++]=t&255}return l}function _(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[e&63]}function f(e,t,o){var n;var r=[];for(var s=t;s<o;s+=3){n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(e[s+2]&255);r.push(_(n))}return r.join("")}function h(e){var t;var o=e.length;var r=o%3;var s=[];var a=16383;for(var l=0,i=o-r;l<i;l+=a){s.push(f(e,l,l+a>i?i:l+a))}if(r===1){t=e[o-1];s.push(n[t>>2]+n[t<<4&63]+"==")}else if(r===2){t=(e[o-2]<<8)+e[o-1];s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")}return s.join("")}}}]);
//# sourceMappingURL=9214.f290f3653115e786e3a5.js.map?v=f290f3653115e786e3a5